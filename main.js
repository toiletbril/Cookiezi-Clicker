const e=document.getElementById("amount"),k=document.getElementById("cps_shop_items"),m=document.getElementById("shop_items"),n=document.getElementById("tap_power"),p=document.getElementById("cps"),q=document.getElementById("upgrades_count"),u=document.getElementById("change_keys"),v=document.getElementById("keys"),w=document.getElementById("main"),x=document.getElementById("bpm");y("All elements are not null",!!e&&!!k&&!!m&&!!n&&!!k&&!!q&&!!u&&!!v&&!!x&&!!w);const z=Math.floor(40-40/11);
function y(a,b){if(!b)throw Error("Assertion failed: "+a);}const B=(a,b)=>{var c=A.i.s;return`Tap ${0>=c?"?":a.toUpperCase()}/${1>=c?"?":b.toUpperCase()} to gain pp.`};
function C(a,b,c,d){const h=document.createElement("li"),f=document.createElement("button"),g=document.createElement("div"),l=document.createElement("div"),r=document.createElement("p"),t=document.createElement("p"),J=document.createTextNode(`${a.name}, ${a.h}${"pp"}`);b=document.createTextNode(b);const K=document.createTextNode(a.j);f.onclick=d;a=c+a.id;h.setAttribute("id","list_"+a);f.setAttribute("id","button_"+a);t.setAttribute("id","p_stat_"+a);r.setAttribute("id","p_"+a);l.setAttribute("id",
"desc_div_"+a);g.setAttribute("id","div_"+a);f.appendChild(J);t.appendChild(b);r.appendChild(K);l.appendChild(r);l.appendChild(t);"cps_item"==c&&(c=document.createElement("p"),c.setAttribute("id","p_producing_"+a),l.appendChild(c));g.appendChild(f);g.appendChild(l);h.appendChild(g);return h}
function D(a){const b=Array(a.m.length).fill(1);for(const c in a.v){if(0===a.g[c])continue;const d=a.v[c];if("multiplier"===d?.action.type)for(const h in d.action.D){const f=d.action.D[h];b[f]=b[f]*a.g[f]*d.action.value}}return b}function E(a){const b=D(a);y("multipliers is valid length",b.length===a.m.length);return a.u.map((c,d)=>c*a.m[d].o*b[d]).reduce((c,d)=>c+d)}
function F(a){for(const b in a.g){const c=a.v[b];0<a.g[b]&&(document.getElementById("button_item"+c.id).disabled=!0);0<a.g[parseInt(b)-1]&&(document.getElementById("list_item"+c.id).hidden=!1)}}
function G(a){const b=D(a);for(const c in a.u){const d=a.m[c],h=document.getElementById("button_cps_item"+d.id),f=document.getElementById("p_stat_cps_item"+d.id),g=a.u[d.id];h.textContent=`${d.name}, ${d.h}${"pp"}`;f.textContent=`+${d.o*b[d.id]} ${"pp"}/s`;0<g&&(document.getElementById("p_producing_cps_item"+d.id).textContent=`You have ${g}, producing ${(d.o*g*b[d.id]).toFixed(1)} ${"pp"}/s`);0<a.u[parseInt(c)-1]&&(document.getElementById("list_cps_item"+d.id).hidden=!1)}}
class H{constructor(){this.m=[{id:0,name:"Keyboard macro",j:"Flimsy macro on an old keyboard.",h:80,o:.4},{id:1,name:"Logitech",j:"Item description =D",h:340,o:1},{id:2,name:"A drill",j:"Drill, usually fitted with a driving tool attachment, now fitted with a keyboard.",h:1860,o:4},{id:3,name:"Vaxei",j:"Item description =D",h:8420,o:10},{id:4,name:"Cookiezi",j:"Item description =D",h:44500,o:50}];this.v=[{id:0,name:"Buldak",j:"You start to sweat.",stat:"+0.6 pp/tap",h:520,action:{type:"tap_power",
value:.6}},{id:1,name:"Gateron switch",j:"You order some switches.",stat:"Keyboard button is twice more effective.",h:840,action:{type:"multiplier",D:[0],value:2}},{id:2,name:"Mousepad",j:"Finally, less mouse drift.",stat:"+1.2 pp/tap",h:1300,action:{type:"tap_power",value:1.2}},{id:3,name:"Wacom",j:"Item description =D",stat:"+3.2 pp/tap",h:4600,action:{type:"tap_power",value:3.2}},{id:4,name:"Power outlet",j:"The consequences of industrial revolution.",stat:"Keyboard buttons and drills become twice as effective.",
h:10640,action:{type:"multiplier",D:[1,2],value:2}},{id:5,name:"Sugar",j:"Item description =D",stat:"Vaxei becomes twice as effective.",h:18900,action:{type:"multiplier",D:[3],value:2}},{id:6,name:"Wooting",j:"You finally receive your Wooting.",stat:"Click power is doubled.",h:23200,action:{type:"tap_power_multiplier",value:2}},{id:7,name:"Cookiezi comeback",j:"Chocomint's Made of Fire HDDT 98.54 full combo. Without a doubt, one of the most impressive plays ever set in osu! history, but one that takes some experience to appreciate fully.",
stat:"Cookiezi becomes twice as effective.",h:69420,action:{type:"multiplier",D:[4],value:2}}];this.u=Array(this.m.length).fill(0);this.g=Array(this.v.length).fill(0)}G(a){this.g[a.id]+=1;document.getElementById("button_item"+a.id).disabled=!0;F(this);G(this)}H(a){this.u[a.id]+=1;this.m[a.id].h=Math.floor(1.15*this.m[a.id].h);G(this)}}function I(a){var b=A;a.C||(a.C=!0,b.g.A+=1,b.amount+=b.J,b.g.I=!0,clearInterval(b.g.L),b.g.L=setTimeout(()=>{b.g.I=!1},1E3))}
function L(a){const b=a.g.A*z/a.g.B;x.textContent=Math.floor(60*b/4)+" BPM";e.textContent=Math.floor(a.amount).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")+"pp";p.textContent="pp/s: "+(a.F+b).toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g,",");n.textContent="pp/tap: "+a.J;q.textContent="Items bought: "+a.l.u.reduce((c,d)=>c+d,0)}
class M{constructor(){var a=N;this.K=0;this.g={L:0,I:!1,A:0,B:40};this.amount=0;this.J=1;this.F=0;this.l=a;this.i={keys:[{key:"z",C:!1},{key:"x",C:!1}],s:-1};y("settings.keys is of KEY_COUNT size",2===this.i.keys.length)}H(a){const b=this;return function(){b.amount<a.h?alert('Not enough pp to buy "'+a.name+'" :('):(b.amount-=a.h,b.l.H(a),G(b.l),b.F=E(b.l))}}G(a){const b=this;return function(){if(b.amount<a.h)alert('Not enough pp to buy "'+a.name+'" :(');else{b.amount-=a.h;b.l.G(a);F(b.l);var c=b.l;
let d=1,h=1;for(const f in c.g){if(0===c.g[f])continue;const g=c.v[f];switch(g?.action.type){case "tap_power":d+=g.action.value*c.g[f];break;case "tap_power_multiplier":h*=g.action.value*c.g[f]}}b.J=d*h;b.F=E(b.l)}}}}const N=new H,A=new M;var O=A;for(const a in O.l.m){const b=O.l.m[a],c=C(b,`+${b.o} ${"pp"}/s`,"cps_item",O.H(b));0<parseInt(a)&&(c.hidden=!0);k.appendChild(c)}for(const a in O.l.v){const b=O.l.v[a],c=C(b,b.stat,"item",O.G(b));0<parseInt(a)&&(c.hidden=!0);m.appendChild(c)}
setInterval(()=>{var a=A;a.amount+=a.F/40;a.g.I?a.g.B+=1:40!=a.g.B?(a.g.A=Math.floor(a.g.A/a.g.B*z),a.g.B=40):0<a.g.A&&--a.g.A;L(a)},25);document.addEventListener("keydown",a=>{const b=A.i.keys[0],c=A.i.keys[1];if(0<=A.i.s)A.i.keys[A.i.s].key=a.key,A.i.s+=1,v.textContent=B(b.key,c.key),2<=A.i.s&&(A.i.s=-1,u.textContent="Change keys...");else switch(a.key.toLowerCase()){case b.key:I(b);break;case c.key:I(c)}});
document.addEventListener("keyup",a=>{const b=A.i.keys[0],c=A.i.keys[1];switch(a.key.toLowerCase()){case b.key:b.C=!1;break;case c.key:c.C=!1}});u.onclick=()=>{const a=A.i.keys[0],b=A.i.keys[1];A.i.s=0;v.textContent=B(a.key,b.key);u.textContent="Press a new key..."};window.onfocus=()=>{const a=(new Date).getTime()-A.K;1E3<a&&(A.amount+=a/1E3*A.F)};window.onblur=()=>{A.K=(new Date).getTime()};
