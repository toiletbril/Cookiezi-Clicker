'use strict';const g=document.getElementById("amount"),k=document.getElementById("pps_shop_items"),l=document.getElementById("general_shop_items"),m=document.getElementById("tap_power"),n=document.getElementById("pps"),t=document.getElementById("upgrade_count"),u=document.getElementById("change_keys"),v=document.getElementById("keys"),w=document.getElementById("stats_list"),x=document.getElementById("game_title"),A=document.getElementById("game"),B=document.getElementById("main"),C=document.getElementById("footer_text");
console.assert(!!g&&!!k&&!!l&&!!m&&!!t&&!!u&&!!v&&!!w&&!!B&&!!x,"All elements are not null");const D=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);function E(a,b,c){return`Tap ${0>=c?"?":a.toUpperCase()}/${1>=c?"?":b.toUpperCase()} to gain pp.`}function F(a,b){return a.toFixed(b).replace(/\B(?=(\d{3})+(?!\d))/g,",")}
function G(a,b,c,d){const f=document.createElement("li"),e=document.createElement("button"),h=document.createElement("div"),q=document.createElement("div"),y=document.createElement("div"),p=document.createElement("div"),r=document.createElement("p"),z=document.createElement("p"),Q=document.createTextNode(a.name),R=document.createTextNode(F(a.i,0)+"pp");b=document.createTextNode(b);const S=document.createTextNode(a.m);e.onclick=d;a=c+a.id;f.setAttribute("id","list_"+a);e.setAttribute("id","button_"+
a);z.setAttribute("id","p_stat_"+a);r.setAttribute("id","p_"+a);p.setAttribute("id","desc_div_"+a);y.setAttribute("id","cost_div_"+a);h.setAttribute("id","div_"+a);r.setAttribute("class","description");y.appendChild(R);q.appendChild(Q);e.appendChild(q);e.appendChild(y);z.appendChild(b);r.appendChild(S);p.appendChild(z);p.appendChild(r);"pps_item"===c&&(c=document.createElement("p"),c.setAttribute("id","p_producing_"+a),p.appendChild(c));h.appendChild(e);h.appendChild(p);f.appendChild(h);return f}
function H(a){alert(`${"To be fair, you have to have a very high IQ to understand technical            mapping. The SV changes are extremely subtle, and without a solid               grasp of music theory most of the quality will go over a typical                player's head. There's also Monstrata's triangular outlook, which is            deftly woven into his mapping - his personal philosophy draws heavily           from Pishifat literature, for instance. The fans understand this                stuff; they have the intellectual capacity to truly appreciate the              Depths of these patterns, to realize that they're not just high                 quality- they say something deep about MAPPING. As a consequence                people who dislike technical maps truly ARE idiots- of course they              wouldn't appreciate, for instance, the quality in Sotarks'                      existencial catchphrase \"this needs more overdone jumps,\" which               itself is a Cryptic reference to Monstrata's map quaver. I'm smirking           right now just imagining one of those addlepated simpletons                     scratching their heads in confusion as Natsu's genius unfolds itself            on their computer screens. What fools... how I pity them. And yes               by the way, I DO have a Monstrata slider butterfly tattoo.And no,               you cannot see it.It's for the ladies' eyes only - And even they have           to demonstrate that they're within 5 PP points of my own (preferably            lower) beforehand."}\n\nYou completed the game in ${Math.floor(((new Date).getTime()-
a.J)/1E3/60)} minutes.\nThanks for playing.`)}let I=0,J=0;function K(a){const b=Array(a.g.length).fill(1);for(const d in a.o){var c=parseInt(d,10);if(!1!==a.j[c]&&(c=a.o[c],"multiplier"===c.action.type))for(const f in c.action.u)b[c.action.u[f]]*=c.action.value}return b}function L(a){const b=K(a);console.assert(b.length===a.g.length,"multipliers is valid length");return a.h.map((c,d)=>c*a.g[d].v*b[d]).reduce((c,d)=>c+d)}
class M{constructor(){this.g=[{id:J++,name:"Keyboard button",m:"A button on an old keyboard.",i:80,v:.4},{id:J++,name:"Trackball",m:"A pointing device.",i:540,v:2.6,l:[{type:"has_pps_upgrade",item:0,amount:4}]},{id:J++,name:"Drill",m:"Drill, usually fitted with a driving tool attachment,                    now fitted with a keyboard.",i:2770,v:8,l:[{type:"has_pps_upgrade",item:1,amount:6}]},{id:J++,name:"Vaxei",m:"The following README will serve to document all of Vaxei's skins.",i:19E3,v:52,l:[{type:"has_pps_upgrade",
item:2,amount:6}]},{id:J++,name:"Cookiezi",m:"Shigetora, better known online as chocomint and formerly as Cookiezi,                    is a famous South Korean osu!standard player.",i:85E3,v:184,l:[{type:"has_pps_upgrade",item:3,amount:6}]},{id:J++,name:"Aetrna",m:"Once, he fingered a girl. She died.",i:996E3,v:1020,l:[{type:"has_pps_upgrade",item:4,amount:6}]},{id:J++,name:"peppy",m:"The creator of the.",i:8496E3,v:9800,l:[{type:"has_pps_upgrade",item:5,amount:6}]}];this.o=[{id:I++,name:"Bateron switch",
m:"You order some switches.",stat:"Keyboard buttons are twice more effective.",i:340,action:{type:"multiplier",u:[0],value:2},l:[{type:"has_pps_upgrade",item:0,amount:5}]},{id:I++,name:"Spicy ramen",m:"You start to sweat.",stat:"+0.6 pp/tap",i:620,action:{type:"tap_power",value:.6}},{id:I++,name:"Mousepad",m:"Finally, less mouse drift.",stat:"+1.2 pp/tap",i:1800,action:{type:"tap_power",value:1.2},l:[{type:"has_upgrade",item:0}]},{id:I++,name:"Vacom toilet",m:"10 Reasons Why You Might Want a High-Tech Super Toilet.",
stat:"+3.2 pp/tap",i:5600,action:{type:"tap_power",value:3.2},l:[{type:"has_upgrade",item:2}]},{id:I++,name:"Ultra lube",m:"You waste several hours lubing your keyboard.",stat:"Keyboard buttons are twice more effective.",i:8040,action:{type:"multiplier",u:[0],value:2},l:[{type:"has_pps_upgrade",item:0,amount:12}]},{id:I++,name:"Power outlet",m:"The consequences of industrial revolution.",stat:"Trackballs and drills become twice as effective.",i:15640,action:{type:"multiplier",u:[1,2],value:2},l:[{type:"has_pps_upgrade",
item:1,amount:4},{type:"has_pps_upgrade",item:2,amount:2}]},{id:I++,name:"Mooting",m:"You finally receive your Mooting keyboard.",stat:"Click power is doubled.",i:23200,action:{type:"tap_power_multiplier",value:2},l:[{type:"has_upgrade",item:5}]},{id:I++,name:"Sugar",m:"The generic name for sweet-tasting, soluble carbohydrates,                    many of which are used in food.",stat:"Vaxei becomes twice as effective.",i:104900,action:{type:"multiplier",u:[3],value:2},l:[{type:"has_pps_upgrade",item:3,
amount:6}]},{id:I++,name:"PP rework",m:"I am justice, I am honor, I am hope and living water.",stat:"You gain +20% PP/s",i:282E3,action:{type:"multiplier",u:[0,1,2,3,4,5],value:1.2},l:[{type:"has_pps_upgrade",item:3,amount:10}]},{id:I++,name:"Cookiezi comeback",m:"Chocomint's Made of Fire HDDT 98.54 full combo.                    Without a doubt, one of the most impressive plays ever set in osu! history,                    but one that takes some experience to appreciate fully.",stat:"Cookiezi becomes twice as effective.",
i:379E3,action:{type:"multiplier",u:[4],value:2},l:[{type:"has_pps_upgrade",item:4,amount:3}]},{id:I++,name:"Rising fevers",m:"Ascencion to heaven.",stat:"Xeltol is twice more effective.",i:726E4,action:{type:"multiplier",u:[5],value:2},l:[{type:"has_pps_upgrade",item:5,amount:6}]},{id:I++,name:"osu! lazer",m:"2042.",stat:"You gain 20% PP/s.",i:1406E4,action:{type:"multiplier",u:[0,1,2,3,4,5],value:1.2},l:[{type:"has_upgrade",item:9},{type:"has_upgrade",item:10},{type:"has_pps_upgrade",item:5,amount:6}]},
{id:I++,name:"Private jet",m:"Make peppy's dreams come true.",stat:"Makes peppy work twice as fast.",i:29E6,action:{type:"multiplier",u:[6],value:2},l:[{type:"has_pps_upgrade",item:6,amount:4}]},{id:I++,name:"Rank #1",m:"Hopefully this game has given you some osu! of all time.",stat:"...",i:727E5,action:{type:"func",action:H},l:[{type:"has_upgrade",item:11},{type:"has_upgrade",item:12}]}];this.h=Array(this.g.length).fill(0);this.j=Array(this.o.length).fill(!1)}}
function N(a,b){return function(){if(a.o<b.i)alert('Not enough pp to buy "'+b.name+'" :(');else{a.o-=b.i;var c=a.h;c.h[b.id]+=1;c.g[b.id].i=Math.floor(1.15*c.g[b.id].i);O(a);P(a);a.B=L(a.h)}}}
function T(a,b){return function(){if(a.o<b.i)alert('Not enough pp to buy "'+b.name+'" :(');else{a.o-=b.i;var c=a.h;document.getElementById("button_item"+b.id).disabled=!0;c.j[b.id]=!0;"func"===b.action.type&&b.action.action(a);O(a);P(a);c=a.h;let f=1,e=1;for(const h in c.j){var d=parseInt(h,10);if(!1!==c.j[d])switch(d=c.o[d],null===d||void 0===d?void 0:d.action.type){case "tap_power":f+=d.action.value;break;case "tap_power_multiplier":e*=d.action.value}}a.F=f*e;a.B=L(a.h)}}}
function U(a){for(var b in a.h.g){var c=a.h.g[parseInt(b,10)];const d=G(c,`+${c.v} ${"pp"}/s`,"pps_item",N(a,c));c.l&&d.classList.add("hidden");k.appendChild(d)}for(const d in a.h.o)b=a.h.o[parseInt(d,10)],c=G(b,b.stat,"item",T(a,b)),b.l&&c.classList.add("hidden"),l.appendChild(c)}
function V(a,b){if(!b.l)return!0;for(const c in b.l){const d=b.l[parseInt(c,10)];switch(d.type){case "has_pps":if(a.B<d.value)return!1;break;case "has_pps_upgrade":console.assert(d.item<a.h.h.length,"has_pps_upgrade value is not out of range");if(a.h.h[d.item]<(d.amount||1))return!1;break;case "has_current_pp":if(a.o<d.value)return!1;break;case "has_upgrade":console.assert(d.item<a.h.j.length,"has_upgrade value is not out of range");if(!a.h.j[d.item])return!1;break;case "total_pp":if(a.total<d.value)return!1}}return!0}
function O(a){for(const c in a.h.j){var b=parseInt(c,10);const d=a.h.o[b];a.h.j[b]&&(document.getElementById("button_item"+d.id).disabled=!0);b=document.getElementById("list_item"+d.id);d.l?V(a,d)&&b.classList.remove("hidden"):b.classList.remove("hidden")}}
function P(a){const b=K(a.h);for(const f in a.h.h){const e=a.h.g[parseInt(f,10)];var c=document.getElementById("cost_div_pps_item"+e.id);const h=document.getElementById("p_stat_pps_item"+e.id);var d=a.h.h[e.id];c.textContent=`${F(e.i,0)}${"pp"}`;h.textContent=`+${F(e.v*b[e.id],1)} ${"pp"}/s`;0<d&&(c=document.getElementById("p_producing_pps_item"+e.id),d=`You have ${d}, producing ${F(e.v*d*b[e.id],1)} ${"pp"}/s`,c.textContent=d);d=document.getElementById("list_pps_item"+e.id);e.l?V(a,e)&&d.classList.remove("hidden"):
d.classList.remove("hidden")}}function W(a,b){b.D||(b.D=!0,a.j.A+=1,X(a,a.F),a.j.G=!0,clearInterval(a.j.I),a.j.I=setTimeout(()=>{a.j.G=!1},2E3))}function X(a,b){a.total+=b;a.o+=b}
function Y(a){const b=33*a.j.A/a.j.C,c=F(Math.floor(a.o),0)+"pp",d="pp/s: "+F(a.B,1),f="pp/tap: "+a.F,e="Items bought: "+a.h.h.reduce((h,q)=>h+q,0);-1==a.g.s&&0<b?v.textContent=Math.floor(60*b/4)+" BPM":-1==a.g.s&&(a=E(a.g.keys[0].key,a.g.keys[1].key,2),v.textContent!=a&&(v.textContent=a));g.textContent!=c&&(g.textContent=c);n.textContent!=d&&(n.textContent=d);m.textContent!=f&&(m.textContent=f);t.textContent!=e&&(t.textContent=e)}
class Z{constructor(){this.H=0;this.j={I:0,G:!1,A:0,C:30};this.total=this.o=0;this.F=1;this.B=0;this.J=(new Date).getTime();this.h=new M;this.g={keys:[{key:"z",D:!1},{key:"x",D:!1}],s:-1};console.assert(2===this.g.keys.length,"settings.keys is of KEY_COUNT size")}}
window.onload=()=>{C.textContent="version 5 beta";const a=new Z;U(a);document.addEventListener("keydown",b=>{const c=a.g.keys[0],d=a.g.keys[1];if(0<=a.g.s)a.g.keys[a.g.s].key=b.key,a.g.s+=1,v.textContent=E(c.key,d.key,a.g.s),2<=a.g.s&&(a.g.s=-1,u.disabled=!1,u.textContent="Change keys...");else switch(b.key.toLowerCase()){case c.key:W(a,c);break;case d.key:W(a,d)}});document.addEventListener("keyup",b=>{const c=a.g.keys[0],d=a.g.keys[1];switch(b.key.toLowerCase()){case c.key:c.D=!1;break;case d.key:d.D=
!1}});D?(u.classList.add("hidden"),B.onclick=()=>{X(a,a.F)},v.textContent="Tap here to gain pp."):u.onclick=()=>{const b=a.g.keys[0],c=a.g.keys[1];a.g.s=0;u.disabled=!0;v.textContent=E(b.key,c.key,a.g.s);u.textContent="Press a new key..."};window.onfocus=()=>{X(a,((new Date).getTime()-a.H)/1E3*a.B)};window.onblur=()=>{a.H=(new Date).getTime()};setInterval(()=>{X(a,a.B/30);a.j.G?a.j.C+=1:30!=a.j.C?(a.j.A=Math.floor(a.j.A/a.j.C*33),a.j.C=30):0<a.j.A&&--a.j.A;Y(a)},1E3/30);A.classList.remove("hidden")};
